
<!DOCTYPE html>
<html lang="bg">
<head>
    <title>Command-Line Interfaces</title>
    <meta charset="UTF-8">
    <meta name="keywords" content="rust,fmi">
    <link rel="stylesheet" href="resources/codeblock/codeblock.css">
<link rel="stylesheet" href="resources/frontend/controls.css">
<link rel="stylesheet" href="resources/global/global.css">
<link rel="stylesheet" href="resources/global/metadata.css">
<link rel="stylesheet" href="resources/highlight/hljs-github.css">
<link rel="stylesheet" href="resources/highlight/style.css">
<link rel="stylesheet" href="resources/highlight/tshl-github.css">
<link rel="stylesheet" href="resources/katex/katex.min.css">
<link rel="stylesheet" href="resources/rustc/rustc.css">
<link rel="stylesheet" href="resources/splitview/splitview.css">
<link rel="stylesheet" href="resources/wrapping-pages/wrapping-pages.css">
<script type="text/javascript" src="resources/codeblock/codeblock.js"></script>
<script type="text/javascript" src="resources/frontend/controls.js"></script>
</head>
<body>
    <main>
        <div class="slide">
<h1 id="command-line-interfaces">Command-Line Interfaces</h1>
<h3 id="2-декември-2020">2 декември 2020</h3>
</div><div class="slide">
<h1 id="административни-неща">Административни неща</h1>
<ul>
<li>Предизвикателство 2: <a href="https://fmi.rust-lang.bg/challenges/2" target="_blank">https://fmi.rust-lang.bg/challenges/2</a></li>
</ul>
</div><div class="slide subslide">
<h1 id="административни-неща">Административни неща</h1>
<ul>
<li>Предизвикателство 2: <a href="https://fmi.rust-lang.bg/challenges/2" target="_blank">https://fmi.rust-lang.bg/challenges/2</a></li>
<li>Без лекции на 7ми и 9ти, твърде близко до студентския празник</li>
</ul>
</div><div class="slide">
<h1 id="hangman">Hangman</h1>
<h3 id="demo">Demo</h3>
<p>(Initial commit: <code>ea0a5982b477481a24262b6775c9369b1f3f61d3</code>)</p>
<p>Пълния код: <a href="https://github.com/AndrewRadev/rust-hangman" target="_blank">rust-hangman</a></p>
</div><div class="slide">
<h1 id="преговор-io-типове-и-trait-ове">Преговор: IO типове и trait-ове</h1>
<ul>
<li><code>std::io::Read</code>, <code>std::io::Write</code>: Базови trait-ове за четене и писане</li>
</ul>
</div><div class="slide subslide">
<h1 id="преговор-io-типове-и-trait-ове">Преговор: IO типове и trait-ове</h1>
<ul>
<li><code>std::io::Read</code>, <code>std::io::Write</code>: Базови trait-ове за четене и писане</li>
<li><code>File</code>, <code>Stdin</code>, <code>&amp;[u8]</code>, <code>BufReader</code> -- имплементират <code>Read</code></li>
<li><code>BufReader</code> -- имплементира <code>BufRead</code></li>
</ul>
</div><div class="slide subslide">
<h1 id="преговор-io-типове-и-trait-ове">Преговор: IO типове и trait-ове</h1>
<ul>
<li><code>std::io::Read</code>, <code>std::io::Write</code>: Базови trait-ове за четене и писане</li>
<li><code>File</code>, <code>Stdin</code>, <code>&amp;[u8]</code>, <code>BufReader</code> -- имплементират <code>Read</code></li>
<li><code>BufReader</code> -- имплементира <code>BufRead</code></li>
<li><code>File</code>, <code>Stdout</code> и <code>Stderr</code>, <code>Vec&lt;u8&gt;</code>, <code>BufWriter</code> -- имплементират <code>Write</code></li>
</ul>
</div><div class="slide">
<h1 id="преговор-io-типове-и-trait-ове">Преговор: IO типове и trait-ове</h1>
<p>Добре е да ползваме trait-ове когато можем.</p>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">impl</span> <span class="tshl-type">InputFile</span> {
    <span class="tshl-keyword">fn</span> <span class="tshl-function">from</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-keyword">mut</span> <span class="tshl-variable_parameter">contents</span>: <span class="tshl-keyword">impl</span> io<span class="tshl-punctuation_delimiter">::</span><span class="tshl-type">Read</span><span class="tshl-punctuation_bracket">)</span> -&gt; io<span class="tshl-punctuation_delimiter">::</span><span class="tshl-type">Result</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">InputFile</span><span class="tshl-punctuation_bracket">&gt;</span> {
        <span class="tshl-comment">// ...</span>
    }

    <span class="tshl-comment">// или:</span>
    <span class="tshl-keyword">fn</span> <span class="tshl-function">from</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">R</span>: io<span class="tshl-punctuation_delimiter">::</span><span class="tshl-type">Read</span><span class="tshl-punctuation_bracket">&gt;</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-keyword">mut</span> <span class="tshl-variable_parameter">contents</span>: <span class="tshl-type">R</span><span class="tshl-punctuation_bracket">)</span> -&gt; io<span class="tshl-punctuation_delimiter">::</span><span class="tshl-type">Result</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">InputFile</span><span class="tshl-punctuation_bracket">&gt;</span> {
        <span class="tshl-comment">// ...</span>
    }
}</code></pre>
                    </div>
                    
                </div>
                
<p>Така, функцията <code>InputFile::from</code> може да се извика с файл, но може и със stdin, а може и просто със slice от байтове, идващи от някакъв тестов низ.</p>
<p>"Program to an interface, not an implementation" -- често срещан съвет, който често е прав.</p>
</div><div class="slide">
<h1 id="странична-бележка">Странична бележка</h1>
<p>"Program to an interface, not an implementation" -- не е <em>закон</em>, просто добър съвет.</p>
<ul>
<li><code>File</code> vs <code>TcpStream</code></li>
<li><code>File</code> vs <code>Vec&lt;u8&gt;</code></li>
<li><code>File</code> vs <code>Stdin</code>/<code>Stdout</code></li>
<li><code>File</code> -- няма име</li>
</ul>
</div><div class="slide">
<h1 id="string-vs-str"><code>String</code> vs <code>&amp;str</code></h1>
<ul>
<li><code>fn from_str(s: &amp;str)</code> -&gt; Защо <code>&amp;str</code>, а не <code>String</code>?</li>
</ul>
</div><div class="slide subslide">
<h1 id="string-vs-str"><code>String</code> vs <code>&amp;str</code></h1>
<ul>
<li><code>fn from_str(s: &amp;str)</code> -&gt; Защо <code>&amp;str</code>, а не <code>String</code>?</li>
<li>Със <code>&amp;str</code> -- можем да извикаме функцията и със <code>&amp;str</code>, и със <code>&amp;String</code></li>
<li><code>from_str("foobar")</code></li>
<li><code>from_str(&amp;String::from("foobar"))</code></li>
</ul>
</div><div class="slide subslide">
<h1 id="string-vs-str"><code>String</code> vs <code>&amp;str</code></h1>
<ul>
<li><code>fn from_str(s: &amp;str)</code> -&gt; Защо <code>&amp;str</code>, а не <code>String</code>?</li>
<li>Със <code>&amp;str</code> -- можем да извикаме функцията и със <code>&amp;str</code>, и със <code>&amp;String</code></li>
<li><code>from_str("foobar")</code></li>
<li><code>from_str(&amp;String::from("foobar"))</code></li>
<li>Аналогично, обикновено използваме <code>&amp;[T]</code> като вход на функция, а не <code>&amp;Vec&lt;T&gt;</code></li>
</ul>
</div><div class="slide">
<h1 id="pathbuf-и-path"><code>PathBuf</code> и <code>Path</code></h1>
</div><div class="slide subslide">
<h1 id="pathbuf-и-path"><code>PathBuf</code> и <code>Path</code></h1>
<ul>
<li><code>std::path::PathBuf</code> -- стойност със ownership (като <code>String</code>, <code>Vec</code>)</li>
<li><code>std::path::Path</code> -- нейния "slice" тип (еквивалент на <code>&amp;str</code>, <code>&amp;[T]</code>)</li>
</ul>
</div><div class="slide subslide">
<h1 id="pathbuf-и-path"><code>PathBuf</code> и <code>Path</code></h1>
<ul>
<li><code>std::path::PathBuf</code> -- стойност със ownership (като <code>String</code>, <code>Vec</code>)</li>
<li><code>std::path::Path</code> -- нейния "slice" тип (еквивалент на <code>&amp;str</code>, <code>&amp;[T]</code>)</li>
</ul>

                <div class="code-block">
                    <button type="button" class="btn rustc-copy" data-sha="5fb0dce6894bc46559c54824550b7c08d2350d1d">Copy</button>
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">let</span> home_dir = <span class="tshl-type">PathBuf</span><span class="tshl-punctuation_delimiter">::</span><span class="tshl-function">from</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;/home/andrew&quot;</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
<span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{:?}&quot;</span>, home_dir<span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>

<span class="tshl-keyword">let</span> home_dir_slice: <span class="tshl-operator">&amp;</span><span class="tshl-type">Path</span> = home_dir<span class="tshl-punctuation_delimiter">.</span><span class="tshl-function_method">as_path</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
<span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{:?}&quot;</span>, home_dir_slice<span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span></code></pre>
                    </div>
                    <div class="rustc-container">
                    <pre><div class="rustc hljs">"/home/andrew"
"/home/andrew"</div></pre>
                </div>
                </div>
                
<pre class="rustc-source" data-sha="5fb0dce6894bc46559c54824550b7c08d2350d1d">use std::path::{PathBuf,Path};
fn main() {
let home_dir = PathBuf::from("/home/andrew");
println!("{:?}", home_dir);

let home_dir_slice: &Path = home_dir.as_path();
println!("{:?}", home_dir_slice);
}</pre>
</div><div class="slide">
<h1 id="pathbuf-и-path"><code>PathBuf</code> и <code>Path</code></h1>

                <div class="code-block">
                    <button type="button" class="btn rustc-copy" data-sha="cc52e2b111bcd8cd3e6cdfc5bfae6657571d9a0d">Copy</button>
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">let</span> file_path = <span class="tshl-type">PathBuf</span><span class="tshl-punctuation_delimiter">::</span><span class="tshl-function">from</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;/home/andrew/file.txt&quot;</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
<span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{:?}&quot;</span>, file_path<span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>

<span class="tshl-keyword">let</span> only_file: <span class="tshl-operator">&amp;</span><span class="tshl-type">Path</span> = file_path<span class="tshl-punctuation_delimiter">.</span><span class="tshl-function_method">strip_prefix</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;/home/andrew&quot;</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">.</span><span class="tshl-function_method">unwrap</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
<span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{:?}&quot;</span>, only_file<span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>

<span class="tshl-keyword">let</span> standalone_path: <span class="tshl-operator">&amp;</span><span class="tshl-type">Path</span> = <span class="tshl-type">Path</span><span class="tshl-punctuation_delimiter">::</span><span class="tshl-function">new</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;file.txt&quot;</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
<span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{:?}&quot;</span>, standalone_path<span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span></code></pre>
                    </div>
                    <div class="rustc-container">
                    <pre><div class="rustc hljs">"/home/andrew/file.txt"
"file.txt"
"file.txt"</div></pre>
                </div>
                </div>
                
<pre class="rustc-source" data-sha="cc52e2b111bcd8cd3e6cdfc5bfae6657571d9a0d">use std::path::{PathBuf,Path};
fn main() {
let file_path = PathBuf::from("/home/andrew/file.txt");
println!("{:?}", file_path);

let only_file: &Path = file_path.strip_prefix("/home/andrew").unwrap();
println!("{:?}", only_file);

let standalone_path: &Path = Path::new("file.txt");
println!("{:?}", standalone_path);
}</pre>
</div><div class="slide">
<h1 id="pathbuf-и-path"><code>PathBuf</code> и <code>Path</code></h1>

                <div class="code-block">
                    <button type="button" class="btn rustc-copy" data-sha="a58c3ca3b8136df0517e1ecf40451e5ae33d9a2f">Copy</button>
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">let</span> file_path: <span class="tshl-operator">&amp;</span><span class="tshl-type">Path</span> = <span class="tshl-type">Path</span><span class="tshl-punctuation_delimiter">::</span><span class="tshl-function">new</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;file.txt&quot;</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>

<span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{:?}&quot;</span>, file_path.to_path_buf<span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
<span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{:?}&quot;</span>, file_path.to_owned<span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
<span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{:?}&quot;</span>, file_path.canonicalize<span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span></code></pre>
                    </div>
                    <div class="rustc-container">
                    <pre><div class="rustc hljs">"file.txt"
"file.txt"
Err(Os { code: 2, kind: NotFound, message: "No such file or directory" })</div></pre>
                </div>
                </div>
                
<pre class="rustc-source" data-sha="a58c3ca3b8136df0517e1ecf40451e5ae33d9a2f">use std::path::Path;
fn main() {
let file_path: &Path = Path::new("file.txt");

println!("{:?}", file_path.to_path_buf());
println!("{:?}", file_path.to_owned());
println!("{:?}", file_path.canonicalize());
}</pre>
</div><div class="slide">
<h1 id="debug--display"><code>Debug</code> &amp; <code>Display</code></h1>

                <div class="code-block">
                    <button type="button" class="btn rustc-copy" data-sha="37acd209b715d00a8776d1b5129c474c946df796">Copy</button>
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{:?}&quot;</span>, <span class="tshl-constructor">PathBuf</span>::from<span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;file.txt&quot;</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span></code></pre>
                    </div>
                    <div class="rustc-container">
                    <pre><div class="rustc hljs">"file.txt"</div></pre>
                </div>
                </div>
                
<pre class="rustc-source" data-sha="37acd209b715d00a8776d1b5129c474c946df796">use std::path::PathBuf;
fn main() {
println!("{:?}", PathBuf::from("file.txt"));
}</pre>

                <div class="code-block">
                    <button type="button" class="btn rustc-copy" data-sha="7c03549f224654e1a7d4fd9f1586b8229e8e2a81">Copy</button>
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{}&quot;</span>, <span class="tshl-constructor">PathBuf</span>::from<span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;file.txt&quot;</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span></code></pre>
                    </div>
                    <div class="rustc-container">
                    <pre><div class="rustc hljs"><span style="font-weight:bold;color:rgb(255,85,85)">error[E0277]</span><span style="font-weight:bold">: `PathBuf` doesn't implement `std::fmt::Display`</span>
 <span style="font-weight:bold;color:rgb(85,85,255)">--&gt; </span>src/bin/main_7c03549f224654e1a7d4fd9f1586b8229e8e2a81.rs:3:16
  <span style="font-weight:bold;color:rgb(85,85,255)">|</span>
<span style="font-weight:bold;color:rgb(85,85,255)">3</span> <span style="font-weight:bold;color:rgb(85,85,255)">| </span>println!("{}", PathBuf::from("file.txt"));
  <span style="font-weight:bold;color:rgb(85,85,255)">| </span>               <span style="font-weight:bold;color:rgb(255,85,85)">^^^^^^^^^^^^^^^^^^^^^^^^^</span> <span style="font-weight:bold;color:rgb(255,85,85)">`PathBuf` cannot be formatted with the default formatter</span>
  <span style="font-weight:bold;color:rgb(85,85,255)">|</span>
  <span style="font-weight:bold;color:rgb(85,85,255)">= </span><span style="font-weight:bold">help</span>: the trait `std::fmt::Display` is not implemented for `PathBuf`
  <span style="font-weight:bold;color:rgb(85,85,255)">= </span><span style="font-weight:bold">note</span>: in format strings you may be able to use `{:?}` (or {:#?} for pretty-print) instead
  <span style="font-weight:bold;color:rgb(85,85,255)">= </span><span style="font-weight:bold">note</span>: this error originates in the macro `$crate::format_args_nl` (in Nightly builds, run with -Z macro-backtrace for more info)

<span style="font-weight:bold">For more information about this error, try `rustc --explain E0277`.</span>
<span style="font-weight:bold;color:rgb(255,85,85)">error</span><span style="font-weight:bold">:</span> could not compile `rust` due to previous error</div></pre>
                </div>
                </div>
                
<pre class="rustc-source" data-sha="7c03549f224654e1a7d4fd9f1586b8229e8e2a81">use std::path::PathBuf;
fn main() {
println!("{}", PathBuf::from("file.txt"));
}</pre>
</div><div class="slide">
<h1 id="debug--display"><code>Debug</code> &amp; <code>Display</code></h1>

                <div class="code-block">
                    <button type="button" class="btn rustc-copy" data-sha="f615cb7c033fe3f5591b34c75600d7901210acc7">Copy</button>
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{}&quot;</span>, <span class="tshl-constructor">PathBuf</span>::from<span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;file.txt&quot;</span><span class="tshl-punctuation_bracket">)</span>.display<span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
<span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{}&quot;</span>, <span class="tshl-constructor">Path</span>::new<span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;file.txt&quot;</span><span class="tshl-punctuation_bracket">)</span>.display<span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span></code></pre>
                    </div>
                    <div class="rustc-container">
                    <pre><div class="rustc hljs">file.txt
file.txt</div></pre>
                </div>
                </div>
                
<pre class="rustc-source" data-sha="f615cb7c033fe3f5591b34c75600d7901210acc7">use std::path::{PathBuf,Path};
fn main() {
println!("{}", PathBuf::from("file.txt").display());
println!("{}", Path::new("file.txt").display());
}</pre>
<p>Пътищата на файловата система не са задължително UTF-8-кодирани. Как точно са кодирани зависи супер много от операционната система.</p>
</div><div class="slide">
<h1 id="пътища-и-низове">Пътища и низове</h1>
<ul>
<li><code>pub fn as_os_str(&amp;self) -&gt; &amp;OsStr</code> -- Връща ви низ, както е кодиран natively за операционната система.</li>
<li><code>pub fn to_str(&amp;self) -&gt; Option&lt;&amp;str&gt;</code> -- Връща ви UTF-8 string slice, <em>ако е възможно</em> да се кодира като UTF-8.</li>
<li><code>pub fn to_string_lossy(&amp;self) -&gt; Cow&lt;'_, str&gt;</code> -- Връща ви низ с въпросчета за невалиден UTF-8 (U+FFFD: �).</li>
</ul>
</div><div class="slide subslide">
<h1 id="пътища-и-низове">Пътища и низове</h1>
<ul>
<li><code>pub fn as_os_str(&amp;self) -&gt; &amp;OsStr</code> -- Връща ви низ, както е кодиран natively за операционната система.</li>
<li><code>pub fn to_str(&amp;self) -&gt; Option&lt;&amp;str&gt;</code> -- Връща ви UTF-8 string slice, <em>ако е възможно</em> да се кодира като UTF-8.</li>
<li><code>pub fn to_string_lossy(&amp;self) -&gt; Cow&lt;'_, str&gt;</code> -- Връща ви низ с въпросчета за невалиден UTF-8 (U+FFFD: �).</li>
<li>Ако искате да манипулирате пътища -- ползвате методите на <code>PathBuf</code> и <code>Path</code>.</li>
<li>Ако искате да ги показвате на потребителя, викате им <code>.display()</code>.</li>
<li>Side note: <a href="https://doc.rust-lang.org/stable/std/borrow/enum.Cow.html" target="_blank"><code>std::borrow::Cow</code></a> е интересен тип.</li>
</ul>
</div><div class="slide">
<h1 id="полезни-пакети">Полезни пакети</h1>
<ul>
<li><a href="https://crates.io/crates/walkdir" target="_blank">walkdir</a>: За ефективно обикаляне на файловата система.</li>
<li><a href="https://crates.io/crates/dirs" target="_blank">dirs</a>: За намиране на "стандартни" директории в зависимост от операционната система.</li>
<li><a href="https://crates.io/crates/directories" target="_blank">directories</a>: Подобно на <code>dirs</code>, но включва и конфигурационни директории за инсталиране на приложения.</li>
</ul>
</div><div class="slide">
<h1 id="файлове">Файлове</h1>
<ul>
<li><code>std::fs</code></li>
</ul>
</div><div class="slide subslide">
<h1 id="файлове">Файлове</h1>
<ul>
<li><code>std::fs</code></li>
<li><code>File::open</code> -- отваря път за четене</li>
</ul>
</div><div class="slide subslide">
<h1 id="файлове">Файлове</h1>
<ul>
<li><code>std::fs</code></li>
<li><code>File::open</code> -- отваря път за четене</li>
<li><code>File::open&lt;P: AsRef&lt;Path&gt;&gt;(path: P) -&gt; fs::Result&lt;File&gt;</code></li>
</ul>
</div><div class="slide subslide">
<h1 id="файлове">Файлове</h1>
<ul>
<li><code>std::fs</code></li>
<li><code>File::open</code> -- отваря път за четене</li>
<li><code>File::open&lt;P: AsRef&lt;Path&gt;&gt;(path: P) -&gt; fs::Result&lt;File&gt;</code></li>
<li><code>AsRef&lt;Path&gt;</code> -- нещо, което може евтино да се конвертира до <code>Path</code>, с метода <code>.as_ref()</code></li>
<li><code>File::open(PathBuf::from("..."))</code></li>
<li><code>File::open(Path::new("..."))</code></li>
<li><code>File::open("...")</code></li>
</ul>
</div><div class="slide">
<h1 id="файлове">Файлове</h1>
<ul>
<li><code>File::create</code> -- отваря файл за писане</li>
<li>Ако не съществува, ще го създаде, ако съществува, ще премахне съдържанието му</li>
</ul>
</div><div class="slide">
<h1 id="файлове">Файлове</h1>
<p><code>fs::OpenOptions::new</code> -- отваря файл за четене, писане, append-ване, каквото ви душа иска</p>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">let</span> file = <span class="tshl-type">OpenOptions</span><span class="tshl-punctuation_delimiter">::</span><span class="tshl-function">new</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span>
            <span class="tshl-punctuation_delimiter">.</span><span class="tshl-function_method">read</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-constant_builtin">true</span><span class="tshl-punctuation_bracket">)</span>
            <span class="tshl-punctuation_delimiter">.</span><span class="tshl-function_method">write</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-constant_builtin">true</span><span class="tshl-punctuation_bracket">)</span>
            <span class="tshl-punctuation_delimiter">.</span><span class="tshl-function_method">create</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-constant_builtin">true</span><span class="tshl-punctuation_bracket">)</span>
            <span class="tshl-punctuation_delimiter">.</span><span class="tshl-function_method">open</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;foo.txt&quot;</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span></code></pre>
                    </div>
                    
                </div>
                
</div><div class="slide">
<h1 id="файлове">Файлове</h1>
<p><code>fs::read_to_string</code> -- най-лесния и удобен начин за четене на целия файл директно в низ. Ползвайте го смело за тестове, пък и не само. Понякога, просто знаете, че файла няма да е огромен и че ще ви трябва целия in-memory.</p>
</div><div class="slide">
<h1 id="файлове">Файлове</h1>
<ul>
<li><code>std::io::stdin() -&gt; Stdin</code> -- имплементира <code>Read</code></li>
<li><code>std::io::stdout() -&gt; Stdout</code> -- имплементира <code>Write</code></li>
<li><code>std::io::stderr() -&gt; Stderr</code> -- имплементира <code>Write</code></li>
</ul>
</div><div class="slide subslide">
<h1 id="файлове">Файлове</h1>
<ul>
<li><code>std::io::stdin() -&gt; Stdin</code> -- имплементира <code>Read</code></li>
<li><code>std::io::stdout() -&gt; Stdout</code> -- имплементира <code>Write</code></li>
<li><code>std::io::stderr() -&gt; Stderr</code> -- имплементира <code>Write</code></li>
<li>Буферират се по редове -- при писане, може да ползвате <code>.flush()</code> за да изкарате нещо, което не е цял ред.</li>
</ul>
</div><div class="slide subslide">
<h1 id="файлове">Файлове</h1>
<ul>
<li><code>std::io::stdin() -&gt; Stdin</code> -- имплементира <code>Read</code></li>
<li><code>std::io::stdout() -&gt; Stdout</code> -- имплементира <code>Write</code></li>
<li><code>std::io::stderr() -&gt; Stderr</code> -- имплементира <code>Write</code></li>
<li>Буферират се по редове -- при писане, може да ползвате <code>.flush()</code> за да изкарате нещо, което не е цял ред.</li>
<li>Lock-ват се автомагично с мутекс, но можете ръчно да викнете <code>.lock()</code> за ексклузивен достъп.</li>
</ul>
</div><div class="slide">
<h1 id="include-макроси">include макроси</h1>
<ul>
<li>Четене на данни по време на компилация.</li>
</ul>
</div><div class="slide subslide">
<h1 id="include-макроси">include макроси</h1>
<ul>
<li>Четене на данни по време на компилация.</li>
<li><code>include_bytes!</code> -- набива някакъв файл в кода като статичен комплект от байтове (<code>&amp;'static [u8; N]</code>).</li>
<li><code>include_str!</code> -- набива някакъв файл в кода като <code>&amp;'static str</code>.</li>
</ul>
</div><div class="slide subslide">
<h1 id="include-макроси">include макроси</h1>
<ul>
<li>Четене на данни по време на компилация.</li>
<li><code>include_bytes!</code> -- набива някакъв файл в кода като статичен комплект от байтове (<code>&amp;'static [u8; N]</code>).</li>
<li><code>include_str!</code> -- набива някакъв файл в кода като <code>&amp;'static str</code>.</li>
</ul>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">const</span> <span class="tshl-constructor">MAIN_JS</span>:    <span class="tshl-operator">&amp;</span><span class="tshl-operator">&#39;</span><span class="tshl-label">static</span> <span class="tshl-type_builtin">str</span> = <span class="tshl-function_macro">include_str</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;../res/js/main.js&quot;</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
<span class="tshl-keyword">const</span> <span class="tshl-constructor">MAIN_CSS</span>:   <span class="tshl-operator">&amp;</span><span class="tshl-operator">&#39;</span><span class="tshl-label">static</span> <span class="tshl-type_builtin">str</span> = <span class="tshl-function_macro">include_str</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;../res/style/main.css&quot;</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
<span class="tshl-keyword">const</span> <span class="tshl-constructor">GITHUB_CSS</span>: <span class="tshl-operator">&amp;</span><span class="tshl-operator">&#39;</span><span class="tshl-label">static</span> <span class="tshl-type_builtin">str</span> = <span class="tshl-function_macro">include_str</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;../res/style/github.css&quot;</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span></code></pre>
                    </div>
                    
                </div>
                
<p>С <code>include_bytes!</code> можете да вкарвате и други ресурси, като картинки, аудио…</p>
</div><div class="slide">
<h1 id="stdenv"><code>std::env</code></h1>
<p><code>env::args()</code> -- дава итератор по входа на програмата. Примерно:</p>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
</div>
                        <pre><code>$ cargo run one two three</code></pre>
                    </div>
                    
                </div>
                

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">use</span> std<span class="tshl-punctuation_delimiter">::</span>env<span class="tshl-punctuation_delimiter">;</span>

<span class="tshl-keyword">fn</span> <span class="tshl-function">main</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span> {
    <span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{:?}&quot;</span>, env::args<span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span>.collect::&lt;<span class="tshl-constructor">Vec</span>&lt;<span class="tshl-constructor">String</span>&gt;&gt;<span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
    <span class="tshl-comment">// =&gt; [&quot;target/debug/scratch&quot;, &quot;one&quot;, &quot;two&quot;, &quot;three&quot;]</span>

    <span class="tshl-keyword">use</span> std<span class="tshl-punctuation_delimiter">::</span>ffi<span class="tshl-punctuation_delimiter">::</span><span class="tshl-constructor">OsString</span><span class="tshl-punctuation_delimiter">;</span>
    <span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;{:?}&quot;</span>, env::args_os<span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span>.collect::&lt;<span class="tshl-constructor">Vec</span>&lt;<span class="tshl-constructor">OsString</span>&gt;&gt;<span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
    <span class="tshl-comment">// =&gt; [&quot;target/debug/scratch&quot;, &quot;one&quot;, &quot;two&quot;, &quot;three&quot;]</span>
}</code></pre>
                    </div>
                    
                </div>
                
</div><div class="slide">
<h1 id="stdenv"><code>std::env</code></h1>
<p><code>env::var()</code> -- достъп до environment променливи, може да извади грешка, ако не са валиден unicode, имат <code>\0</code> байтове и т.н. Ако супер много се налага, има <code>env::var_os()</code>.</p>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">if</span> env<span class="tshl-punctuation_delimiter">::</span><span class="tshl-function">var</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;DEBUG&quot;</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">.</span><span class="tshl-function_method">is_ok</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span> {
    <span class="tshl-function_macro">println</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;Debug info: ...&quot;</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
}</code></pre>
                    </div>
                    
                </div>
                

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
</div>
                        <pre><code>$ DEBUG=1 cargo run</code></pre>
                    </div>
                    
                </div>
                
</div><div class="slide">
<h1 id="env-logger">Env logger</h1>
<p>Удобен проект за по-сериозно log-ване: <a href="https://crates.io/crates/env_logger" target="_blank">env_logger</a> + <a href="https://crates.io/crates/log" target="_blank">log</a> (пример от друг проект, <a href="https://github.com/AndrewRadev/rust-quickmd" target="_blank">rust-quickmd</a>)</p>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">fn</span> <span class="tshl-function">init_logging</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span> {
    <span class="tshl-comment">// Release logging:</span>
    <span class="tshl-comment">// - Warnings and errors</span>
    <span class="tshl-comment">// - No timestamps</span>
    <span class="tshl-comment">// - No module info</span>
    <span class="tshl-attribute">#<span class="tshl-punctuation_bracket">[</span>cfg<span class="tshl-punctuation_bracket">(</span>not<span class="tshl-punctuation_bracket">(</span>debug_assertions<span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_bracket">]</span></span>
    env_logger<span class="tshl-punctuation_delimiter">::</span><span class="tshl-function">builder</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">.</span>
        <span class="tshl-function_method">default_format_module_path</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-constant_builtin">false</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">.</span>
        <span class="tshl-function_method">default_format_timestamp</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-constant_builtin">false</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">.</span>
        <span class="tshl-function_method">filter_level</span><span class="tshl-punctuation_bracket">(</span>log<span class="tshl-punctuation_delimiter">::</span><span class="tshl-type">LevelFilter</span><span class="tshl-punctuation_delimiter">::</span><span class="tshl-constructor">Warn</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">.</span>
        <span class="tshl-function_method">init</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>

    <span class="tshl-comment">// Debug logging:</span>
    <span class="tshl-comment">// - All logs</span>
    <span class="tshl-comment">// - Full info</span>
    <span class="tshl-attribute">#<span class="tshl-punctuation_bracket">[</span>cfg<span class="tshl-punctuation_bracket">(</span>debug_assertions<span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_bracket">]</span></span>
    env_logger<span class="tshl-punctuation_delimiter">::</span><span class="tshl-function">builder</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">.</span>
        <span class="tshl-function_method">filter_level</span><span class="tshl-punctuation_bracket">(</span>log<span class="tshl-punctuation_delimiter">::</span><span class="tshl-type">LevelFilter</span><span class="tshl-punctuation_delimiter">::</span><span class="tshl-constructor">Debug</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">.</span>
        <span class="tshl-function_method">init</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
}</code></pre>
                    </div>
                    
                </div>
                
</div><div class="slide">
<h1 id="env-logger">Env logger</h1>
<p>Примерна употреба:</p>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-function_macro">debug</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot;Building HTML:&quot;</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
<span class="tshl-function_macro">debug</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot; &gt; home_path  = {}&quot;</span>, home_path<span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span>
<span class="tshl-function_macro">debug</span><span class="tshl-function_macro">!</span><span class="tshl-punctuation_bracket">(</span><span class="tshl-string">&quot; &gt; scroll_top = {}&quot;</span>, scroll_top<span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_delimiter">;</span></code></pre>
                    </div>
                    
                </div>
                
<p>При пускане на програмата в release mode, премахваме много допълнителна информация като модули и timestamp, и показваме всичко от "warning" нагоре.</p>
<p>При пускане в debug mode (стандарното при <code>cargo run</code>):</p>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
</div>
                        <pre><code>[2019-11-29T08:57:33Z DEBUG quickmd::assets] Building HTML:
[2019-11-29T08:57:33Z DEBUG quickmd::assets]  &gt; home_path  = /home/andrew
[2019-11-29T08:57:33Z DEBUG quickmd::assets]  &gt; scroll_top = 0
[2019-11-29T08:57:33Z DEBUG quickmd::ui] Loading HTML:
[2019-11-29T08:57:33Z DEBUG quickmd::ui]  &gt; output_path = /tmp/.tmpWq7EYh/output.html
[2019-11-29T08:57:33Z DEBUG quickmd::background] Watching ~/.quickmd.css</code></pre>
                    </div>
                    
                </div>
                
</div><div class="slide">
<h1 id="по-сложна-обработка-на-аргументи-чрез-structopt">По-сложна обработка на аргументи чрез structopt</h1>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-punctuation_bracket">[</span>dependencies<span class="tshl-punctuation_bracket">]</span>
structopt = <span class="tshl-string">&quot;*&quot;</span>
structopt-derive = <span class="tshl-string">&quot;*&quot;</span><span class="tshl-punctuation_delimiter"></span></code></pre>
                    </div>
                    
                </div>
                
</div><div class="slide">
<h1 id="по-сложна-обработка-на-аргументи-чрез-structopt">По-сложна обработка на аргументи чрез structopt</h1>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
</div>
                        <pre><code>$ hangman --wordlist=words.txt --attempts=10 --debug
$ hangman -w words.txt -a 10 -d
$ hangman --help
$ hangman --version</code></pre>
                    </div>
                    
                </div>
                
</div><div class="slide">
<h1 id="по-сложна-обработка-на-аргументи-чрез-structopt">По-сложна обработка на аргументи чрез structopt</h1>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
</div>
                        <pre><code class="rustrust language-rust hljs"><span class="tshl-keyword">use</span> structopt_derive<span class="tshl-punctuation_delimiter">::</span><span class="tshl-constructor">StructOpt</span><span class="tshl-punctuation_delimiter">;</span>

<span class="tshl-attribute">#<span class="tshl-punctuation_bracket">[</span>derive<span class="tshl-punctuation_bracket">(</span><span class="tshl-constructor">StructOpt</span>, <span class="tshl-constructor">Debug</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_bracket">]</span></span>
<span class="tshl-attribute">#<span class="tshl-punctuation_bracket">[</span>structopt<span class="tshl-punctuation_bracket">(</span>name=<span class="tshl-string">&quot;hangman&quot;</span>, about=<span class="tshl-string">&quot;A game of Hangman&quot;</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_bracket">]</span></span>
<span class="tshl-keyword">pub</span> <span class="tshl-keyword">struct</span> <span class="tshl-type">Options</span> {
    <span class="tshl-attribute">#<span class="tshl-punctuation_bracket">[</span>structopt<span class="tshl-punctuation_bracket">(</span>short=<span class="tshl-string">&quot;w&quot;</span>, long=<span class="tshl-string">&quot;wordlist&quot;</span>, help=<span class="tshl-string">&quot;The path to a word list&quot;</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_bracket">]</span></span>
    <span class="tshl-property">wordlist_path</span>: <span class="tshl-type">Option</span><span class="tshl-punctuation_bracket">&lt;</span><span class="tshl-type">PathBuf</span><span class="tshl-punctuation_bracket">&gt;</span>,

    <span class="tshl-attribute">#<span class="tshl-punctuation_bracket">[</span>structopt<span class="tshl-punctuation_bracket">(</span>short=<span class="tshl-string">&quot;a&quot;</span>, long=<span class="tshl-string">&quot;attempts&quot;</span>, help=<span class="tshl-string">&quot;The number of attempts to guess the word&quot;</span>, default_value=<span class="tshl-string">&quot;10&quot;</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_bracket">]</span></span>
    <span class="tshl-property">attempts</span>: <span class="tshl-type_builtin">u32</span>,

    <span class="tshl-attribute">#<span class="tshl-punctuation_bracket">[</span>structopt<span class="tshl-punctuation_bracket">(</span>short=<span class="tshl-string">&quot;d&quot;</span>, long=<span class="tshl-string">&quot;debug&quot;</span>, help=<span class="tshl-string">&quot;Show debug info&quot;</span><span class="tshl-punctuation_bracket">)</span><span class="tshl-punctuation_bracket">]</span></span>
    <span class="tshl-property">debug</span>: <span class="tshl-type_builtin">bool</span>,
}</code></pre>
                    </div>
                    
                </div>
                
</div><div class="slide">
<h1 id="по-сложна-обработка-на-аргументи-чрез-structopt">По-сложна обработка на аргументи чрез structopt</h1>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
</div>
                        <pre><code>$ hangman --help
hangman 0.1.0
A game of Hangman

USAGE:
    hangman [FLAGS] [OPTIONS]

FLAGS:
    -d, --debug      Show debug info
    -h, --help       Prints help information
    -V, --version    Prints version information

OPTIONS:
    -a, --attempts &lt;attempts&gt;         The number of attempts to guess the word [default: 10]
    -w, --wordlist &lt;wordlist-path&gt;    The path to a word list</code></pre>
                    </div>
                    
                </div>
                
<p>(С <code>cargo run</code> ще е <code>cargo run -- --help</code>)</p>
</div><div class="slide">
<h1 id="ограничения-на-structopt">Ограничения на structopt</h1>
<ul>
<li>Трудно дебъгване на грешки (доста compile-time магия)</li>
<li>Липса на гъвкавост?</li>
<li>В краен случай, може би решението е (използвания отдолу пакет) <a href="https://github.com/kbknapp/clap-rs" target="_blank">clap</a></li>
<li>За по-прости неща, и <a href="https://crates.io/crates/docopt" target="_blank">docopt</a> може да е удобен вариант</li>
</ul>
</div><div class="slide">
<h1 id="локално-инсталиране-на-пакет">Локално инсталиране на пакет</h1>
<ul>
<li><code>cargo install --path .</code></li>
<li>Инсталира нещата в <code>~/.cargo/bin/</code></li>
<li><code>hangman -w wordlist.txt</code></li>
<li>Може да имаме повече от един executable file. Слагаме ги в <code>src/bin/</code>, всеки си има собствен main. Може да ги викаме локално със <code>cargo run --bin &lt;име-на-файла&gt;</code>, а при cargo install ще си се инсталират като отделни binary-та. Пример от друг проект: <a href="https://github.com/AndrewRadev/id3-image/tree/727623693685acc085e8379c5e9da358284896bf/src" target="_blank">rust-id3-image</a></li>
</ul>
</div><div class="slide">
<h1 id="features">Features</h1>
<p>Може да си намалите малко броя dependencies, като премахнете default features:</p>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</div>
                        <pre><code>[dependencies]
structopt = { version = "*", default-features = false }
structopt-derive = "*"</code></pre>
                    </div>
                    
                </div>
                
<p>Документацията е в clap: <a href="https://docs.rs/clap/*/clap/#features-enabled-by-default" target="_blank">https://docs.rs/clap/*/clap/#features-enabled-by-default</a></p>
</div><div class="slide">
<h1 id="версии">Версии</h1>
<p>Окей е да използваме <code>*</code> за версия, когато си пишем кода -- конкретните версии се фиксират в <code>Cargo.lock</code>. Ако искаме да го публикуваме като пакет в crates.io, използвайки <code>cargo publish</code>, трябва да фиксираме конкретни версии, примерно:</p>

                <div class="code-block">
                    
                    <div class="code-container">
                        <div class="line-numbers hljs"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</div>
                        <pre><code>[dependencies]
dirs = "2.0.2"
rand = "0.7.2"
structopt = { version = "0.3.5", default-features = false }
structopt-derive = "0.3.5"</code></pre>
                    </div>
                    
                </div>
                
<p>Може да намерите плъгини за редакторите си, които да ви помогнат с избора на версии:</p>
<ul>
<li>VSCode: <a href="https://github.com/serayuzgur/crates" target="_blank">https://github.com/serayuzgur/crates</a></li>
<li>Vim: <a href="https://github.com/mhinz/vim-crates" target="_blank">https://github.com/mhinz/vim-crates</a></li>
</ul>
</div><div class="slide">
<h1 id="още-полезни-пакети">Още полезни пакети</h1>
<ul>
<li><a href="https://github.com/rust-lang-nursery/lazy-static.rs" target="_blank">lazy_static</a> -- дефиниране на константи с код</li>
<li><a href="https://github.com/serde-rs/serde" target="_blank">serde</a> -- за писане и четене на структурирани данни (конфигурация, например)</li>
<li><a href="https://github.com/crossterm-rs/crossterm" target="_blank">crossterm</a>, <a href="https://github.com/gyscos/Cursive" target="_blank">cursive</a>, <a href="https://github.com/redox-os/termion" target="_blank">termion</a> -- повече контрол над терминали</li>
</ul>
</div><div class="slide">
<h1 id="въпроси">Въпроси</h1>
</div>
    </main>
</body>
</html>
